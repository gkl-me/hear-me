<%- include('nav') %>


<div class="signup d-flex justify-content-center my-5 ">
    <div class="signup-form-container d-flex flex-column  text-center ">
        <h2 class="text-center">Create an account</h2>
        <p class="text-center">Enter your email to sign up for this app</p>
        <form action="/user/signup" method="post" id="signup-form">
            <div class="form-group">
                <input type="text" class="form-control form-input" id="name-signup" name="name" placeholder="Full Name" autocomplete="off" required>
            </div>
            <div class="form-group">
                <input type="email" class="form-control form-input" id="email-signup" name="email" placeholder="Email Address" autocomplete="off" required>
            </div>
            <div class="form-group">
                <input type="text" class="form-control form-input" id="phone-signup" name="phone" placeholder="Phone Number" autocomplete="off" required>
            </div>

            <div class="form-group position-relative d-flex align-items-center">
                <input type="password" class="form-control form-input" id="pass-signup" name="password" placeholder="Password" required>
                <span id="toggle-password" onclick="togglePassword('pass-signup',this)" class="me-1 password-toggle align-content-center position-absolute end-0"><i class="bi bi-eye"></i></span>
            </div>            


            <div class="form-group position-relative d-flex align-items-center">
                <input type="password" class="form-control form-input" id="confirm-signup" placeholder="Confirm Password" required>
                <span id="toggle-password" onclick="togglePassword('confirm-signup',this)" class="me-1 password-toggle align-content-center position-absolute end-0"><i class="bi bi-eye"></i></span>
            </div>
            <span id="signup-error"  style="display: none; color: red;">Password doesnot match</span>


            <button type="submit" id="signup-button" class="btn submit-btn">Sign up with email</button>
            <p class="text-center text-black-50  mt-3">Already have an account? <a href="/user/login">Login</a></p>
            <hr>
            <button type="button" class="btn submit-btn-light">
                <img width="25px" height="25px" src="/public/assets/google-icon" alt="">
                <a href="/user/auth/google">Continue with Google</a>
            </button>
            <p class="text-center mt-3">
                By clicking continue, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
            </p>
        </form>
    </div>
</div>


<script>
    function password() {
    const pass = document.getElementById('pass-signup').value;
    const confirm = document.getElementById('confirm-signup').value;

    if (pass !== confirm) {
        document.getElementById('signup-error').style.display = 'block';
    } else {
        document.getElementById('signup-error').style.display = 'none';
    }
}


//toggle password eye 

    function togglePassword(fieldId, toggleElement) {
        const passwordField = document.getElementById(fieldId);
        const type = passwordField.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordField.setAttribute('type', type);
        toggleElement.innerHTML = type === 'password' ? '<i class="bi bi-eye"></i>' : '<i class="bi bi-eye-slash"></i>';
    }

document.getElementById('pass-signup').addEventListener('input', password);
document.getElementById('confirm-signup').addEventListener('input', password);

document.getElementById('signup-form').addEventListener('submit', function (event) {

    event.preventDefault();

    const pass = document.getElementById('pass-signup').value;
    const confirm = document.getElementById('confirm-signup').value;
    const name = document.getElementById('name-signup').value;
    const email = document.getElementById('email-signup').value;
    const phone = document.getElementById('phone-signup').value;

    const capitalLetterRegex = /^[A-Z]/;
    const letterNumberRegex = /^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8}$/;
    let isValid = true;

    if (name.trim() === "") {
        isValid = false;
        Swal.fire({
            title: "Invalid Input",
            text: "Name cannot be empty.",
            icon: "error"
        });
        return;
    }

    if (email.trim() === "") {
        isValid = false;
        Swal.fire({
            title: "Invalid Input",
            text: "Email cannot be empty.",
            icon: "error"
        });
        return;
    }

    if (phone.trim() === "" || isNaN(Number(phone))) {
        isValid = false;
        Swal.fire({
            title: "Invalid Input",
            text: "Phone cannot be empty and must be a number.",
            icon: "error"
        });
        return;
    }

    if (!capitalLetterRegex.test(pass)) {
        isValid = false;
        Swal.fire({
            title: "Invalid Password",
            text: "Password must start with a capital letter.",
            icon: "error"
        });
        return;
    }

    if (!letterNumberRegex.test(pass)) {
        isValid = false;
        Swal.fire({
            title: "Invalid Password",
            text: "Password must be 8 characters long and contain both letters and numbers.",
            icon: "error"
        });
        return;
    }

    if (pass !== confirm) {
        isValid = false;
        Swal.fire({
            title: "Password Mismatch",
            text: "Passwords do not match.",
            icon: "error"
        });
        return;
    }

    if (isValid) {
            document.getElementById('signup-form').submit();
    }
});

</script>

<%- include('../admin/adminFooter') %>